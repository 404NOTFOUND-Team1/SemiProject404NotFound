var videoStatistics=null;videoStatsEvent={READY:"playerReady",IDLE:"idle",PLAY:"play",PAUSE:"pause",COMPLETE:"complete",ERROR:"error",SEEK:"seek",VIDEO_TIME:"videoTime",CURRENT_TIME:"position",DURATION:"duration",VIDEO_CHANGE:"videoChange"},cuePointStatsEvent={START:"cuePointstart",CLICK:"cuePointclick"},JSON.stringify=JSON.stringify||function(e){var t=typeof e;if("object"!=t||null===e)return"string"==t&&(e='"'+e+'"'),String(e);var n,r,o=[],i=e&&e.constructor==Array;for(n in e)"string"==(t=typeof(r=e[n]))?r='"'+r+'"':"object"==t&&null!==r&&(r=JSON.stringify(r)),o.push((i?"":'"'+n+'":')+String(r));return(i?"[":"{")+String(o)+(i?"]":"}")},JSON.parse=JSON.parse||function(str){return""===str&&(str='""'),eval("var p="+str+";"),p},function(e){"function"==typeof define&&define.amd?define(e):e()}(function(){return videoStatistics=function(e,t,n){var r=t;null==n&&(n="");var o=e.getLocalPath(),i="//play"+n+".wecandeo.com/html/libs/jquery-1.8.1.min.js",a="//play"+n+".wecandeo.com/html/utils/userAgent.js",s="//api"+n+".wecandeo.com/v1/player/stats/info.jsonp?k={KEY}",u="https://couscous.acs"+n+".wecandeo.io/play/api/videoPlays",c="https://couscous.acs"+n+".wecandeo.io/video/api/videoSections",d="https://couscous.acs"+n+".wecandeo.io/video/api/videoCuePoints",l="jsonp";""!=o&&(s=o+"/json/info.json?k={KEY}",l="json");var f,v,p,E=null,g=!1,S=!1,h=!1,m=!1,y=!1,x=!1,I=!1,C=null,A=null,N=[],T=10,j=10,O=0,P=0,w=0,R=0;function D(){null!=E&&E(!1)}function U(e,t){var n=document.createElement("script");n.src=location.protocol+e,n.onload=n.onreadystatechange=function(){"loaded"!=this.readyState&&"complete"!=this.readyState&&null!=this.readyState||t()},n.onerror=D,document.getElementsByTagName("head")[0].appendChild(n)}function L(){$.ajax({type:"GET",timeout:3e3,dataType:l,jsonp:"callback",url:location.protocol+s.replace("{KEY}",r),success:function(e){var n;R=0,e.statsInfo.errorInfo&&1<e.statsInfo.errorInfo.errorMessage.length?console.log(e.statsInfo.errorInfo.errorMessage):(S=!0,C=e.statsInfo,""!=o&&(C.cs=(new Date).getTime(),C.uid=(n=(new Date).getTime(),window.performance&&"function"==typeof window.performance.now&&(n+=performance.now()),"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==e?t:3&t|8).toString(16)})),C.ref=document.referrer||location.origin),C.ref=function(e){e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):(127<r&&r<2048?t+=String.fromCharCode(r>>6|192):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128)),t+=String.fromCharCode(63&r|128))}return t}(e);for(var t,n,r,o,i,a,s="",u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=0;c<e.length;)r=(a=e.charCodeAt(c++))>>2,o=(3&a)<<4|(t=e.charCodeAt(c++))>>4,i=(15&t)<<2|(n=e.charCodeAt(c++))>>6,a=63&n,isNaN(t)?i=a=64:isNaN(n)&&(a=64),s=s+u.charAt(r)+u.charAt(o)+u.charAt(i)+u.charAt(a);return s}(document.referrer),M())},error:function(e,t,n){console.log("loadVideoData Error code:"+e.status+"\nmessage:"+e.responseText+"\nerror:"+n),++R<3?L():E&&E(!1)}})}function M(e){"function"==typeof e&&(E=e),0!=g&&0!=S&&(I=!0,C.fv="object"==typeof smUserAgent?smUserAgent.getFlashVersion().major+"."+smUserAgent.getFlashVersion().minor+"."+smUserAgent.getFlashVersion().release:"",k(),null!=E&&(E(!0),E=null))}function k(){if(!(N.length<=0)){for(var e in N)K(N[e][0],N[e][1]);N=[]}}function K(e,t){switch(A=null,delete(A=JSON.parse(JSON.stringify(C))).errorInfo,e){case videoStatsEvent.SEEK:case videoStatsEvent.PAUSE:if(0==y)return;case videoStatsEvent.IDLE:case videoStatsEvent.COMPLETE:A.dtt=w,A.dst=O,A.det=P}if(e==videoStatsEvent.READY){if(1==y)return;A.e="pl"}else if(e==videoStatsEvent.PLAY){if(1==m?m=!1:O=parseInt(P),1==h&&(h=!1),1==y)return;if(A.e="vs",A.dtt=w,x=!(m=!(y=!(P=O=0))),isNaN(w)||null==w||w<=0)return void(x=!1)}else if(e==videoStatsEvent.PAUSE){if(A.e="vp",m=!1,A.det<=A.dst)return}else if(e==videoStatsEvent.IDLE||e==videoStatsEvent.COMPLETE){if(0==y)return;A.e="vt",Y()}else{if(e!=videoStatsEvent.SEEK){if(e!=videoStatsEvent.VIDEO_TIME)return e==cuePointStatsEvent.START?J("cv",t):e==cuePointStatsEvent.CLICK?J("cc",t):e==videoStatsEvent.VIDEO_CHANGE?b(t.key):void 0;if("currentTime"!=t.type&&t.type!=videoStatsEvent.CURRENT_TIME||0!=h||1!=y)"duration"==t.type&&(w=parseInt(t.value));else{if(isNaN(w)||null==w||w<=0){if(null==t.duration||isNaN(t.duration)||!(0<t.duration))return;w=parseInt(t.duration)}if(0==x&&(x=!0,A.e="vs",A.dtt=w,A.dst=0,V(u,A)),t.value<0)return;if((P+1<parseInt(t.value)||Math.max(P-1,0)>parseInt(t.value))&&O<P)return A.e="vk",A.dtt=w,A.dst=O,A.det=P,O=parseInt(t.value),P=parseInt(t.value),void V(u,A);if(P=t.value>w?parseInt(w):parseInt(t.value),j<=P-O)return A.e="vi",A.dtt=w,A.dst=O,A.det=P,V(u,A),void(O=P);j=P<60?5:10;var n=parseInt(t.value/w*100);if(isNaN(n))return;if(e=parseInt(n/T)+1,f!=T*(e=100<=n?100/T:e)){if(A.dtt=w,f=T*e,A.section=f,A.ver="date : 2017-02-14-ver , duration : "+typeof w+" , section : "+typeof f,null==A.section||null==A.dtt)return;delete A.ref,V(c,A)}}return}if(A.e="vk",h=!0,0==t.seeking)return m=!0,O=parseInt(t.time),P=parseInt(t.time),void(h=!1);if(A.det<=A.dst)return}V(u,A)}function J(e,t){A.e=e,A.cpid=t.cpid,delete A.ref,V(d,A)}function V(e,t){if(null!=t.dst&&null!=t.det){if(v==t.dst&&p==t.det)return;v=t.dst,p=t.det}$.ajax({type:"GET",timeout:3e3,dataType:"jsonp",contentType:"text/plain; charset=UTF-8",url:e+"?data="+encodeURIComponent(JSON.stringify(t)),success:function(e){},error:function(e,t,n){}})}function b(e){null!=e&&r!=e&&(Y(),I=!1,r=e,L())}function Y(){m=y=!1,p=v=f=O=0}null!=e?(_model=e,_model.registerObserver(this),g=!0,L(),M()):function e(){return"function"!=typeof jQuery?U(i,e):"object"!=typeof smUserAgent?U(a,e):(g=!0,L(),void M())}(),this.getDuration=function(){return w},this.setKey=b,this.update=K,this.onReady=M,this.setLog=function(e,t){I?(k(),K(e,t)):N[N.length]=[e,t]}}});